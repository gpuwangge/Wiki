# Security Sockets Layers(SSL)
SSL英文全称是“Secure Sockets Layer”，中文含义为“安全套接层”，及其继任者传输层安全（Transport Layer Security，TLS）是为网络通信提供安全及数据完整性的一种安全协议。 TLS与SSL在传输层对网络连接进行加密，保障数据传输安全。

# 基本概念

Certificate Authority: 一个第三方机构，负责颁发证书(CA)。比如微软，google或Mozilla。  

SSL系统：有些假的第三方机构也可以颁发假的证书。SSL系统负责认证证书的真伪。当Chrome等浏览器打开伪证书认证的网站时，会提示不安全。  

Certificate: 如果新创建网站，可以去VeriSign等公司购买证书。办好的证书是一个私钥(.key)和一个证书(.cer)文件。每个证书都有一个数字签名。使用SSL系统的网站URL开头看起来是这样：https//，而不是http//  

PEM文件：很多.key和.cer文件都是pem文件格式的。因此看到一个.pem文件时，它可能是私钥，也可能是证书，也可能是两者都具备。用户通过持有.pem文件来验证服务器的身份。.pem文件本身的来源必须可靠。  




# SSL的私钥和公钥系统
## 公钥
一把可以公开的钥匙。可以用来加密，也可以解密私钥加密过的文件，也可以用来签名。 

## 私钥
一把不应该公开的钥匙。可以用来加密，也可以解密公钥加密过的文件，也可以用来签名。  

## 签名
把目标文件用Hash函数生成摘要(Digest)，然后用私钥对摘要加密，就可以生成签名(Signature)。  

## 场景演示
小A有重要的文件要传递给小B。  
黑客小C奉命取得这个文件。  
小B先准备好一对公钥(b)和私钥(b)。其中私钥(b)自己藏好，并把公钥(b)发给小A。  
小C可能会拦截得到公钥(b)，但公钥(b)即使泄露给小A以外的人也无所谓。  
假若小A使用公钥(b)加密文件(b)并传给小B，这份文件只能用小B的私钥(b)解密。因此，即使传文件过程中被黑客小C获得，小C也无法获知其文件内容。  
但是由于小C可以获得公钥(b)，因此小C可以拦截加密文件(b)，然后用公钥(b)做一份假的文件传给小B，这样小B存在被黑客小C愚弄的结果。（中间人攻击）  
小A和小B为了传递正确的文件，他们决定使用签名。  
首先，小A也准备一对公钥(a)和私钥(a)。同样他把公钥(a)分享给小B。  
然后，小A使用私钥(a)对文件产生签名(a)。小A把加密文件(b)和签名(a)一起发送给小B。  
当小B收到两份文件后，先使用公钥(a)解密签名，得到文件摘要。再用私钥(b)解密文件本体。文件本体必须跟文件摘要hash对接上。如果对不上，则说明此文件被黑客篡改。  
这样，小C是无法进行中间人攻击的，因为他没有私钥(a)，因此无法生成签名(a)。  

## 浏览器-服务器场景
这里的服务器就相当于小A，浏览器就相当于小B。服务器需要把正确的网站内容发给浏览器，而浏览器需要把这个内容呈现给用户，并保证这个内容是不被黑客篡改过的。  


xxxxxxxxxxxxxxxxxx  
双方指服务器和用户(浏览器)。目的是让双方得知另一方身份的真实性。原则上由一个共同信任的第三方(CA)来确认。  

公钥：浏览器持有的钥匙。在浏览器将信息发到服务器之前，使用公钥加密。其信息只能用私钥解密。是公开的钥匙。  

私钥：Web服务器持有的钥匙。使用私钥加密过的文件只能用公钥解密。是不能公开的钥匙。  

具体做法：  
1.浏览器试图打开某网站  
2.服务器返回该网站的公钥和证书  
3.浏览器检查证书的真伪  
4.浏览器使用公钥加密一个随机的对称密钥，加上加密后的URL和http数据，发回服务器。  
5.服务器使用私钥解密对称密钥，并解密URL和http数据  
6.服务器使用对称密钥加密HTML文档和http数据并发回浏览器  
7.浏览器使用对称密钥解密HTML文档和http数据并展示给用户  







